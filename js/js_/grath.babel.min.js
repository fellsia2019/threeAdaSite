"use strict";var _index=require("https://unpkg.com/polymorph-js@0.2.4/lib.es2015/index.js"),_graph=require("https://cdn.jsdelivr.net/gh/greghub/funnel-graph-js@master/src/js/graph.js"),_number=require("https://cdn.jsdelivr.net/gh/greghub/funnel-graph-js@master/src/js/number.js");function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}console.log("kkkkkkkkkkkkkkkkkkkkkkkk");var VueFunnelGraph=Vue.component("VueFunnelGraph",{name:"VueFunnelGraph",props:{animated:{type:Boolean,default:!1},width:[String,Number],height:[String,Number],values:Array,labels:Array,colors:{type:Array,default:function(){return[]}},subLabels:Array,direction:{type:String,default:"horizontal"},gradientDirection:{type:String,default:"horizontal"},displayPercentage:{type:Boolean,default:!0}},data:function(){return{paths:[],prevPaths:[],graph:null,tween:null,defaultColors:(0,_graph.getDefaultColors)(10)}},computed:{valuesFormatted:function(){return this.graph.is2d()?this.graph.getValues2d().map(function(t){return(0,_number.formatNumber)(t)}):this.values.map(function(t){return(0,_number.formatNumber)(t)})},colorSet:function(){for(var t=[],e=0,n=0;n<this.paths.length;n++){var i=this.graph.is2d()?this.getColors[n]:this.getColors,s="string"==typeof i||1===i.length?"solid":"gradient";"gradient"==s&&(e+=1),t.push({values:i,fillMode:s,fill:"solid"==s?i:"url('#funnelGradient-".concat(e,"')")})}return t},gradientSet:function(){var e=[];return this.colorSet.forEach(function(t){"gradient"===t.fillMode&&e.push(t)}),e},getColors:function(){return this.colors instanceof Array&&0===this.colors.length?(0,_graph.getDefaultColors)(this.is2d()?this.values[0].length:2):this.colors.length<this.paths.length?_toConsumableArray(this.colors).concat(_toConsumableArray(this.defaultColors).splice(this.paths.length,this.paths.length-this.colors.length)):this.colors},gradientAngle:function(){return"rotate(".concat("vertical"===this.gradientDirection?90:0,")")}},methods:{enterTransition:function(t,e){this.animated||e(),setTimeout(function(){return e()},700)},leaveTransition:function(t,e){this.animated||e(),setTimeout(function(){return e()},700)},is2d:function(){return this.graph.is2d()},percentages:function(){return this.graph.createPercentages()},twoDimPercentages:function(){return this.is2d()?this.graph.getPercentages2d():[]},subLabelBackgrounds:function(t){return this.is2d()?(0,_graph.generateLegendBackground)(this.getColors[t],this.gradientDirection):[]},offsetColor:function(t,e){return"".concat(Math.round(100*t/(e-1)),"%")},makeAnimations:function(){var s=this;null!==this.tween&&this.tween.stop();var a=[],r=this.prevPaths.length!==this.paths.length,o={x:.5,y:.5};r&&(o={x:0,y:.5},this.graph.isVertical()&&(o={x:1,y:1}),this.graph.is2d()||(o={x:0,y:1})),this.paths.forEach(function(t,e){var n=s.prevPaths[e]||s.graph.getPathMedian(e);r&&(n=s.graph.getPathMedian(e));var i=(0,_index.interpolate)([n,t],{addPoints:1,origin:o,optimize:"fill",precision:1});a.push(i)});var e={value:0};this.tween=new TWEEN.Tween(e).to({value:1},700).easing(TWEEN.Easing.Cubic.InOut).onUpdate(function(){for(var t=0;t<s.paths.length;t++)s.paths[t]=a[t](e.value),s.paths.__ob__.dep.notify()}),this.tween.start(),function t(){TWEEN.update()&&requestAnimationFrame(t)}()},drawPaths:function(){var e=this;this.prevPaths=this.paths,this.paths=[],this.graph.getPathDefinitions().forEach(function(t){e.paths.push(t)})}},beforeMount:function(){this.graph=new FunnelGraph({height:this.height,width:this.width,direction:this.direction,data:{labels:this.labels,values:this.values}}),this.drawPaths(),this.animated&&this.makeAnimations()},watch:{values:function(){this.graph.setValues(this.values),this.drawPaths(),this.animated&&this.makeAnimations()},direction:function(){this.graph.setDirection(this.direction).setWidth(this.width).setHeight(this.height),this.drawPaths()}},template:'<template>\n    <div class="funnel svg-funnel-js" :class="{\'svg-funnel-js--vertical\': direction === \'vertical\'}">\n        <div class="svg-funnel-js__container">\n            <svg :width="width" :height="height">\n                <defs>\n                    <linearGradient :id="\'funnelGradient-\' + (index + 1)"\n                                    v-for="(colors, index) in gradientSet"\n                                    :key="index"\n                                    :gradientTransform="gradientAngle"\n                    >\n                        <stop :stop-color="color"\n                              :offset="offsetColor(index, colors.values.length)"\n                              v-for="(color, index) in colors.values"\n                              :key="index"\n                        ></stop>\n                    </linearGradient>\n                </defs>\n                <path :fill="colorSet[index].fill" :stroke="colorSet[index].fill"\n                      :d="path" v-for="(path, index) in paths" :key="index"\n                ></path>\n            </svg>\n        </div>\n        <transition-group class="svg-funnel-js__labels" name="appear" tag="div"\n                          v-on:enter="enterTransition" v-on:leave="leaveTransition"\n        >\n            <div class="svg-funnel-js__label" :class="\'label-\' + (index + 1)"\n                 v-for="(value, index) in valuesFormatted" :key="labels[index].toLowerCase().split(\' \').join(\'-\')"\n            >\n                <div class="label__value">{{ value }}</div>\n                <div class="label__title" v-if="labels">{{ labels[index] }}</div>\n                <div class="label__percentage" v-if="displayPercentage && percentages()[index] !== 100">\n                    {{ percentages()[index] }}%\n                </div>\n                <div class="label__segment-percentages" v-if="is2d()">\n                    <ul class="segment-percentage__list">\n                        <li v-for="(subLabel, j) in subLabels" :key="j">\n                            {{ subLabel }}:\n                            <span class="percentage__list-label">{{ twoDimPercentages()[index][j] }}%</span>\n                        </li>\n                    </ul>\n                </div>\n            </div>\n        </transition-group>\n        <transition name="fade" v-on:enter="enterTransition" v-on:leave="leaveTransition">\n            <div class="svg-funnel-js__subLabels" v-if="is2d()">\n                <div :class="\'svg-funnel-js__subLabel svg-funnel-js__subLabel-\' + (index + 1)"\n                     v-for="(subLabel, index) in subLabels"\n                     :key="index"\n                >\n                    <div class="svg-funnel-js__subLabel--color"\n                         :style="subLabelBackgrounds(index)"></div>\n                    <div class="svg-funnel-js__subLabel--title">{{ subLabel }}</div>\n                </div>\n            </div>\n        </transition>\n    </div>\n</template>\n        '});new Vue({el:"#app",components:{VueFunnelGraph:VueFunnelGraph},data:function(){return{labels:["Impressions","Add To Cart","Buy"],subLabels:[],values:[12e3,5700,930],colors:["#FFB178","#FF3C8E"],direction:"horizontal",gradientDirection:"horizontal",height:300,width:800,dataSetNum:1}},methods:{useDataSet1:function(){this.labels=["Impressions","Add To Cart","Buy"],this.subLabels=[],this.values=[12e3,4700,930],this.colors=["#FFB178","#FF3C8E"]},useDataSet2:function(){this.labels=["Impressions","Add To Cart","Buy"],this.subLabels=[],this.values=[14e3,9100,1230],this.colors=["#A0BBFF","#EC77FF"]},useDataSet3:function(){this.labels=["Impressions","Add To Cart","Buy"],this.subLabels=["Direct","Social Media","Ads"],this.values=[[3e3,2500,6500],[3e3,1700,1e3],[600,200,130]],this.colors=[["#FFB178","#FF78B1","#FF3C8E"],["#A0BBFF","#EC77FF"],["#A0F9FF","#7795FF"]]},useDataSet4:function(){this.labels=["Impressions","Add To Cart","Buy","Return"],this.subLabels=[],this.values=[14e3,9100,4230,260],this.colors=["#FF4589","#FF5050"]},useDataSet5:function(){this.labels=["Impressions","Add To Cart","Buy"],this.subLabels=[],this.values=[12650,4230,263],this.colors=["#FF9A9A","#FFB178"]},useDataSet6:function(){this.labels=["Impressions","Add To Cart","Buy"],this.subLabels=["Direct","Social Media","Ads","Other"],this.values=[[3e3,2500,2e3,4500],[3e3,1700,500,500],[600,200,100,30]],this.colors=[["#A0BBFF","#EC77FF"],["#FFB178","#FF78B1","#FF3C8E"],["#A0F9FF","#7795FF"]]},makeVertical:function(){this.direction="vertical",this.height=500,this.width=400,this.gradientV()},makeHorizontal:function(){this.direction="horizontal",this.height=300,this.width=800,this.gradientH()},toggleDirection:function(){"horizontal"===this.direction?this.makeVertical():this.makeHorizontal()},gradientV:function(){this.gradientDirection="vertical"},gradientH:function(){this.gradientDirection="horizontal"},toggleGradient:function(){"horizontal"===this.gradientDirection?this.gradientV():this.gradientH()},getNextSet:function(){this.dataSetNum++,6<this.dataSetNum&&(this.dataSetNum=1),this["useDataSet".concat(this.dataSetNum)]()}}});